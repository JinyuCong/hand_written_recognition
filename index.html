<!DOCTYPE HTML>
<html>

<head>
	<title>å­—ç¬¦è¯†åˆ«</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<noscript>
		<link rel="stylesheet" href="assets/css/noscript.css" />
	</noscript>
</head>

<body class="is-preload">

	<!-- Header -->
	<section id="header">
		<div class="inner">
			<h1>å­—ç¬¦è¯†åˆ«</h1>
			<p>ä¸Šä¼ æˆ–ç²˜è´´å›¾ç‰‡è¿›è¡Œè¯†åˆ«</p>
		</div>
	</section>

	<!-- Main Section -->
	<section id="one" class="main style1">
		<div class="container">
			<div class="row gtr-150">
				<div class="col-6 col-12-medium">
					<header class="major">
						<h2>ä¸Šä¼ /ç²˜è´´å›¾ç‰‡</h2>
					</header>
					<input type="file" id="fileInput" accept="image/*">
					<div id="pasteBox" contenteditable="true" class="paste-area">ç²˜è´´å›¾ç‰‡åˆ°è¿™é‡Œ</div>
					<img id="imagePreview" src="" style="max-width: 100%; display: none;">
					<br>
					<button onclick="uploadImage()">è¯†åˆ«</button>
				</div>
				<div class="col-6 col-12-medium imp-medium">
					<h3>è¯†åˆ«ç»“æžœ: <span id="result"></span></h3>
				</div>
			</div>
		</div>
	</section>

	<!-- Footer -->
	<section id="footer">
		<ul class="icons">
			<li>
				<a href="#" class="icon brands alt fa-github">
					<span class="label">GitHub</span>
				</a>
				<a
					href="https://github.com/JinyuCong/hand_written_recognition">https://github.com/JinyuCong/hand_written_recognition</a>
			</li>
		</ul>
		<ul class="copyright">
			<li>&copy; 2024/2025 - CONG Jinyu - YANG Ke - ZHANG Yu</li>
			<li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
		</ul>
	</section>

	<!-- Scripts -->
	<script>
		let imageData = null;

		document.getElementById("fileInput").addEventListener("change", function (event) {
			let file = event.target.files[0];
			if (file) {
				let reader = new FileReader();
				reader.onload = function (e) {
					document.getElementById("imagePreview").src = e.target.result;
					document.getElementById("imagePreview").style.display = "block";
					imageData = file;
				};
				reader.readAsDataURL(file);
			}
		});

		document.getElementById("pasteBox").addEventListener("paste", function (event) {
			let items = (event.clipboardData || event.originalEvent.clipboardData).items;
			for (let item of items) {
				if (item.type.indexOf("image") !== -1) {
					let blob = item.getAsFile();
					let reader = new FileReader();
					reader.onload = function (e) {
						document.getElementById("imagePreview").src = e.target.result;
						document.getElementById("imagePreview").style.display = "block";
						imageData = blob;
					};
					reader.readAsDataURL(blob);
					break;
				}
			}
		});

		function uploadImage() {
			if (!imageData) {
				alert("è¯·å…ˆä¸Šä¼ æˆ–ç²˜è´´å›¾ç‰‡");
				return;
			}
			let formData = new FormData();
			formData.append("file", imageData);

			fetch("http://127.0.0.1:8000/predict", {
				method: "POST",
				body: formData
			})
				.then(response => response.json())
				.then(data => {
					console.log("API è¿”å›ž:", data);  // ðŸ‘‰ è¿™é‡ŒæŸ¥çœ‹ API è¿”å›žçš„æ•°æ®
					if (data.predicted_class) {
						document.getElementById("result").innerText = data.predicted_class;
					} else {
						document.getElementById("result").innerText = "è¯†åˆ«å¤±è´¥: " + (data.error || "æœªçŸ¥é”™è¯¯");
					}
				})
				.catch(error => console.error("è¯·æ±‚å‡ºé”™:", error));

		}
	</script>
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/jquery.scrolly.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>
</body>

</html>